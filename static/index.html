<!DOCTYPE html>
<html>
<head>
    <title>ðŸ“ˆ Market AI Search</title>
    <style>
        body { font-family: Arial; background: #0f172a; color: white; text-align: center; }
        input, button { padding: 10px; margin: 5px; font-size: 16px; }
        table { margin: auto; border-collapse: collapse; }
        td, th { border: 1px solid #555; padding: 8px; }
    </style>
</head>
<body>

<h1>ðŸ“ˆ Market AI Search</h1>

<input id="symbol" placeholder="RELIANCE.NS">
<button onclick="analyze()">Analyze</button>

<p id="status"></p>
<div id="result"></div>

<script>
async function analyze() {
    const symbol = document.getElementById("symbol").value;
    document.getElementById("status").innerText = "Analyzing...";
    document.getElementById("result").innerHTML = "";

    try {
        const res = await fetch(`/analyze?symbol=${symbol}`);
        const data = await res.json();

        if (data.error) {
            document.getElementById("status").innerText = data.error;
            return;
        }

        document.getElementById("status").innerText =
            `${data.symbol} â€” ${data.signal} (${data.confidence_}%)`;

        let html = "<table><tr><th>TF</th><th>Price</th><th>VWAP</th><th>EMA5</th><th>EMA10</th><th>EMA20</th><th>Cross</th><th>Guppy</th></tr>";

        for (const tf in data.analysis) {
            const a = data.analysis[tf];
            html += `<tr>
                <td>${tf}</td>
                <td>${a.Price}</td>
                <td>${a.VWAP}</td>
                <td>${a.EMA5}</td>
                <td>${a.EMA10}</td>
                <td>${a.EMA20}</td>
                <td>${a.EMA_Cross}</td>
                <td>${a.Guppy}</td>
            </tr>`;
        }

        html += "</table>";
        document.getElementById("result").innerHTML = html;

    } catch (e) {
        document.getElementById("status").innerText = "Network error";
    }
}
</script>

</body>
</html>
