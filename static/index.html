<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Market AI Search</title>
<style>
body { font-family: Arial, sans-serif; margin: 20px; }
input { padding: 5px; width: 200px; }
button { padding: 5px 10px; }
table { border-collapse: collapse; width: 100%; margin-top: 20px; }
th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
th { background: #f0f0f0; }
</style>
</head>
<body>
<h2>ðŸ“ˆ Market AI Search</h2>
<input id="symbol" type="text" placeholder="Enter stock symbol like RELIANCE.NS">
<button onclick="analyzeStock()">Analyze</button>

<div id="result"></div>

<script>
async function analyzeStock(){
    const symbol = document.getElementById("symbol").value.trim();
    if(!symbol){ alert("Enter symbol"); return; }

    try {
        const res = await fetch(`/analyze?symbol=${symbol}`);
        const data = await res.json();

        if(data.error){
            document.getElementById("result").innerHTML = `<p style="color:red">${data.error}</p>`;
            return;
        }

        let html = `<h3>${data.symbol} â€” ${data.signal} (${data.probability_%}%)</h3>`;
        html += `<table><tr><th>Timeframe</th><th>Price</th><th>VWAP</th><th>EMA 5</th><th>EMA 10</th><th>EMA 20</th><th>EMA 50</th><th>EMA5/10 Cross</th><th>Guppy</th><th>SuperTrend</th></tr>`;

        for(const tf of ["Daily","Weekly","Monthly","Intraday_1H","Intraday_4H"]){
            const a = data.analysis[tf];
            html += `<tr>
                <td>${tf}</td>
                <td>${a.Price}</td>
                <td>${a.VWAP}</td>
                <td>${a.EMA_5}</td>
                <td>${a.EMA_10}</td>
                <td>${a.EMA_20}</td>
                <td>${a.EMA_50}</td>
                <td>${a.EMA_5_10_Cross}</td>
                <td>${a.Guppy_Trend}</td>
                <td>${a.SuperTrend}</td>
            </tr>`;
        }
        html += "</table>";
        document.getElementById("result").innerHTML = html;

    } catch(err){
        document.getElementById("result").innerHTML = `<p style="color:red">Network error: ${err}</p>`;
    }
}
</script>
</body>
</html>
