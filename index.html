<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Market AI Stock Analyzer</title>
<style>
/* ... (same style code as above) ... */
</style>
</head>
<body>

<h1>Market AI Stock Analyzer</h1>

<div id="search-container">
    <input type="text" id="symbol-input" placeholder="Enter Stock Symbol e.g. RELIANCE.NS">
    <button onclick="fetchAnalysis()">Search</button>
</div>

<div id="result-container">
    <div id="signal-summary"></div>
    <div id="tables-container"></div>
</div>

<script>
async function fetchAnalysis() {
    const symbol = document.getElementById('symbol-input').value.trim();
    const tablesContainer = document.getElementById('tables-container');
    const signalSummary = document.getElementById('signal-summary');

    tablesContainer.innerHTML = '';
    signalSummary.innerHTML = '';

    if (!symbol) {
        tablesContainer.innerHTML = '<div class="error">Please enter a stock symbol.</div>';
        return;
    }

    tablesContainer.innerHTML = 'Fetching data...';

    try {
        // Replace with your Render deployment URL
        const response = await fetch(`https://<your-render-app>.onrender.com/analyze?symbol=${symbol}`);
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        const data = await response.json();

        if (data.error) {
            tablesContainer.innerHTML = `<div class="error">${data.error}</div>`;
            return;
        }

        const signalClass = data.signal === 'BUY' ? 'signal-buy' : data.signal === 'SELL' ? 'signal-sell' : 'signal-hold';
        signalSummary.innerHTML = `
            <h2>Symbol: ${data.symbol}</h2>
            <h3>Prediction: <span class="${signalClass}">${data.signal}</span> (${data.probability_%}%)</h3>
        `;

        const timeframes = ['Daily', 'Weekly', 'Monthly', 'Intraday_1H', 'Intraday_4H'];
        timeframes.forEach(tf => {
            if (data.analysis[tf]) {
                const tfData = data.analysis[tf];
                if (tfData.error) {
                    tablesContainer.innerHTML += `<p><strong>${tf}</strong>: ${tfData.error}</p>`;
                    return;
                }

                let tableHTML = `<h3>${tf}</h3><table>`;
                tableHTML += `<tr>
                    <th>Price</th>
                    <th>VWAP</th>
                    <th>EMA_5</th>
                    <th>EMA_10</th>
                    <th>EMA_20</th>
                    <th>EMA_50</th>
                    <th>EMA_5_10_Cross</th>
                    <th>Guppy Trend</th>
                    <th>SuperTrend</th>
                </tr>`;

                tableHTML += `<tr>
                    <td>${tfData.Price}</td>
                    <td>${tfData.VWAP}</td>
                    <td>${tfData.EMA_5}</td>
                    <td>${tfData.EMA_10}</td>
                    <td>${tfData.EMA_20}</td>
                    <td>${tfData.EMA_50}</td>
                    <td>${tfData.EMA_5_10_Cross}</td>
                    <td>${tfData.Guppy_Trend}</td>
                    <td>${tfData.SuperTrend}</td>
                </tr>`;
                tableHTML += `</table>`;

                tablesContainer.innerHTML += tableHTML;
            }
        });

    } catch (error) {
        tablesContainer.innerHTML = `<div class="error">Error fetching data: ${error.message}</div>`;
    }
}
</script>

</body>
</html>
